---
title: FDA Table 17
subtitle: Patients With Adverse Events by Female-Specific FDA Medical Query (Narrow) and Preferred Term, Female Safety Population, Pooled Analyses
format: html
---

::: panel-tabset
## Spec. Screenshot

![](../assets/images/screenshots/table_17.png){fig-align="center"}

## Table

```{r tbl, message=FALSE, warning=FALSE}
# Load Libraries & Data
library(scda)
library(falcon)

adsl <- scda::synthetic_cdisc_dataset("rcd_2022_10_13", "adsl")
adae <- scda::synthetic_cdisc_dataset("rcd_2022_10_13", "adae")

# Pre-Processing - Ensure required variables FMQ01SC and FMQ01NAM exist in adae
set.seed(1)
adae <- dplyr::rename(adae, FMQ01SC = SMQ01SC, FMQ01NAM = SMQ01NAM)
levels(adae$FMQ01SC) <- c("BROAD", "NARROW")
adae$FMQ01SC[is.na(adae$FMQ01SC)] <- "NARROW"
adae$FMQ01NAM <- factor(adae$FMQ01NAM, levels = c(
  unique(adae$FMQ01NAM), "Abnormal Uterine Bleeding", "Amenorrhea",
  "Bacterial Vaginosis", "Decreased Menstrual Bleeding"
))
adae$FMQ01NAM[adae$SEX == "F"] <- as.factor(
  sample(c(
    "Abnormal Uterine Bleeding", "Amenorrhea",
    "Bacterial Vaginosis", "Decreased Menstrual Bleeding"
  ), sum(adae$SEX == "F"), replace = TRUE)
)

# Output Table
risk_diff <- list(arm_x = "B: Placebo", arm_y = "A: Drug X")
make_table_17(adae = adae, alt_counts_df = adsl, risk_diff = risk_diff)
```

## Table Setup

```{r tbl, eval=FALSE, echo=TRUE}
```

## Function Details

### `make_table_17()`

------------------------------------------------------------------------

Required variables:

-   **`adae`**: `adae` must contain `USUBJID`, `SEX`, and the variables
    specified by `arm_var`, `saffl_var`, `pref_var`, `fmqsc_var` and
    `fmqnam_var`.
-   **`alt_counts_df`** (if specified): `USUBJID` and the variables
    specified by `arm_var` and `saffl_var`.

+------------+-------------------------------------------+------------+
| Argument   | Description                               | Default    |
+:===========+:==========================================+:===========+
| `adae`     | (`data.frame`) Dataset (typically ADAE)   | *No        |
|            | required to build table.                  | default*   |
+------------+-------------------------------------------+------------+
| `alt_      | (`character`) Alternative dataset used    | `NULL`     |
| counts_df` | only to calculate column counts.          |            |
+------------+-------------------------------------------+------------+
| `show_     | (`flag`) Whether column counts should be  | `TRUE`     |
| colcounts` | printed.                                  |            |
+------------+-------------------------------------------+------------+
| `arm_var`  | (`character`) Arm variable used to split  | `"ARM"`    |
|            | table into columns.                       |            |
+------------+-------------------------------------------+------------+
| `          | (`character`) Flag variable used to       | `"SAFFL"`  |
| saffl_var` | indicate inclusion in safety population.  |            |
+------------+-------------------------------------------+------------+
| `pref_var` | (`character`) Preferred term variable to  | `          |
|            | use in table.                             | "AEDECOD"` |
+------------+-------------------------------------------+------------+
| `          | (`character`) Sex variable to use in      | `"F"`      |
| sex_scope` | table.                                    |            |
+------------+-------------------------------------------+------------+
| `          | (`character`) FMQ scope value to use in   | `"NARROW"` |
| fmq_scope` | table.                                    |            |
+------------+-------------------------------------------+------------+
| `          | (`character`) FMQ scope variable to use   | `          |
| fmqsc_var` | in table.                                 | "FMQ01SC"` |
+------------+-------------------------------------------+------------+
| `f         | (`character`) FMQ reference name variable | `"         |
| mqnam_var` | to use in table.                          | FMQ01NAM"` |
+------------+-------------------------------------------+------------+
| `lb        | (`character`) If specified, an overall    | `NULL`     |
| l_overall` | column will be added to the table with    |            |
|            | the given value as the column label.      |            |
+------------+-------------------------------------------+------------+
| `          | (named `list`) List of settings to apply  | `NULL`     |
| risk_diff` | to add a risk difference column to the    |            |
|            | table. See                                |            |
|            | [tern::add_riskdi                         |            |
|            | ff()](https://insightsengineering.github. |            |
|            | io/tern/main/reference/add_riskdiff.html) |            |
|            | for more details. List should contain the |            |
|            | following elements:                       |            |
|            |                                           |            |
|            | -   `arm_x`: (required) the name of       |            |
|            |     reference arm.                        |            |
|            |                                           |            |
|            | -   `arm_y`: (required) the name of the   |            |
|            |     arm to compare to the reference arm.  |            |
|            |                                           |            |
|            | -   `col_label`: (optional) label to use  |            |
|            |     for the risk difference column.       |            |
|            |     Defaults to                           |            |
|            |     `"Risk Difference (%) (95% CI)"`.     |            |
|            |                                           |            |
|            | -   `pct`: (optional) whether the output  |            |
|            |     should be returned as percentages.    |            |
|            |     Defaults to `TRUE`.                   |            |
+------------+-------------------------------------------+------------+
| `prune_0`  | (`flag`) Whether all-zero rows should be  | `FALSE`    |
|            | removed from the table.                   |            |
+------------+-------------------------------------------+------------+
| `na_level` | (`character`) String to represent missing | `"<        |
|            | values.                                   | Missing>"` |
+------------+-------------------------------------------+------------+
| `an        | (named `list` of `character`) List of     | `NULL`     |
| notations` | annotations to add to the table. Valid    |            |
|            | annotation types are `title`,             |            |
|            | `subtitles`, `main_footer`, and           |            |
|            | `prov_footer.` Each name-value pair       |            |
|            | should use the annotation type as name    |            |
|            | and the desired string as value.          |            |
+------------+-------------------------------------------+------------+

Source code for this function is available
[here](https://github.com/pharmaverse/falcon/blob/main/R/fda-table_17.R).
:::
